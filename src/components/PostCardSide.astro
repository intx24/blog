---
import type {
    BlogContentCategory,
    BlogContentEyecatch,
} from "../types/blogTypes";
import { toPostDate } from "../utils/dateUtil";
import { removeTags, truncate } from "../utils/stringUtil";
import Eyecatch from "./Eyecatch.astro";

export interface Props {
    contentId: string;
    title: string;
    content: string;
    eyecatch?: BlogContentEyecatch;
    createdAt: string;
    category?: BlogContentCategory;
}

const { contentId, title, content, eyecatch, createdAt, category } =
    Astro.props;
const postDate = toPostDate(createdAt);
const truncatedTitle = truncate(title ?? "", 50);
const truncatedContent = truncate(removeTags(content ?? ""), 400);
const noImageUrl = "/images/post/noimage.png";
const categories = category ? [category.name] : [];
---

<div
    class="card lg:card-side bg-base-100 active:shadow-2xl shadow-xl overflow-hidden hover:opacity-80"
>
    <Eyecatch
        eyecatch={eyecatch}
        date={postDate.date}
        month={postDate.month}
        noImageUrl={noImageUrl}
    />
    <div class="card-body lg:w-full">
        <h2 class="title card-title text-base">
            {truncatedTitle}
        </h2>
        <p class="content text-sm">{truncatedContent}</p>
        <div class="card-actions justify-end">
            {
                categories.map((category) => (
                    <div class="badge badge-sm badge-primary">{category}</div>
                ))
            }
        </div>
    </div>
    <a class="link" href={`${contentId}`}></a>
</div>

<style>
    .card {
        position: relative;
    }
    .link {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
    }
    .card-title {
        height: 24px;
    }
    .content {
        height: 150px;
        overflow: hidden;
    }
</style>
